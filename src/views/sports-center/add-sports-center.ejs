<%- include('../partials/header') %>
    <!-- END #header -->
    <!-- BEGIN #sidebar -->
    <%- include('../partials/sidebar') %>
        <!-- END #sidebar -->
        <!-- BEGIN #content -->
        <div id="content" class="app-content">
            <div class="d-flex align-items-center mb-3">
                <div>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                        <li class="breadcrumb-item active">
                            <%= title %>
                        </li>
                    </ul>
                    <h1 class="page-header mb-0">Add New Sports Center</h1>
                </div>
                <div class="ms-auto">
                    <a href="#" class="btn btn-theme"><i class="fa fa-plus-circle fa-fw me-1"></i> Create Sports
                        Center</a>
                </div>
            </div>
            <form method="POST" action="admin/sports-center/create-sports-center" enctype="multipart/form-data">
                <div class="row gx-4">
                    <div class="col-xl-8">
                        <div class="card mb-4">
                            <div class="card-header bg-none fw-bold"> Sports Center Information </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Sports Center Name <span
                                            class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="sports_center_name"
                                        placeholder="Sports Center name" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Address</label>
                                    <input type="text" class="form-control" name="sports_center_address"
                                        placeholder="Address" required>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Website</label>
                                            <input type="text" class="form-control" name="website" placeholder="Website"
                                                required>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Phone Number</label>
                                            <input type="text" class="form-control" name="phone"
                                                placeholder="Phone Number" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Average price per session (e.g 25000)</label>
                                    <input type="number" class="form-control" name="session_price"
                                        placeholder="Average price" required>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Longitude</label>
                                            <input type="text" class="form-control" name="longitude"
                                                placeholder="Longitude" required>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Latitude</label>
                                            <input type="text" class="form-control" name="latitude"
                                                placeholder="Latitude" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="">
                                    <label class="form-label">Sports Center Description <span
                                            class="text-danger">*</span></label>
                                    <textarea class="form-control" id="summernote" rows="10"
                                        name="sports_center_description" required></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4">
                        <div class="card mb-4">
                            <div class="card-header bg-none fw-bold d-flex align-items-center">
                                <div class="flex-1">
                                    <div>Features</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="featuresDropdown"></div>
                                <input type="hidden" name="sports_center_features" id="featuresInput" required>
                            </div>
                        </div>
                        <div class="card mb-4">
                            <div class="card-header bg-none fw-bold d-flex align-items-center">
                                <div class="flex-1">
                                    <div>Games</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="gamesDropdown"></div>
                                <input type="hidden" name="sports_center_games" id="gamesInput" required>
                            </div>
                        </div>
                        <div class="card mb-4">
                            <div class="card-header bg-none fw-bold d-flex align-items-center">
                                <div class="flex-1">
                                    <div>Upload Cover Image</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <input type="file" class="form-control" id="coverImageInput" name="cover_photo"
                                    accept="image/*" required>
                                <div class="mt-3">
                                    <img id="coverImagePreview" src="#" alt="Image Preview"
                                        class="img-fluid rounded d-none" style="max-height: 250px;" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <center><button class="btn btn-primary" type="submit">Create</button></center>
                </div>
            </form>
            <!-- New row content starts here -->
        </div>
        <script>
            document.getElementById('coverImageInput').addEventListener('change', function (event) {
                const file = event.target.files[0];
                const preview = document.getElementById('coverImagePreview');

                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        preview.src = e.target.result;
                        preview.classList.remove('d-none');
                    };

                    reader.readAsDataURL(file);
                } else {
                    preview.src = '#';
                    preview.classList.add('d-none');
                }
            });
        </script>
        <script>
            function createMultiSelectDropdown(containerId, inputId, options) {
                const container = document.getElementById(containerId);
                const hiddenInput = document.getElementById(inputId);

                // Create dropdown button
                const dropdownButton = document.createElement("button");
                dropdownButton.className = "btn btn-primary dropdown-toggle";
                dropdownButton.type = "button";
                dropdownButton.dataset.bsToggle = "dropdown";
                dropdownButton.innerText = "Choose Options";

                // Create dropdown menu
                const dropdownMenu = document.createElement("ul");
                dropdownMenu.className = "dropdown-menu p-2";

                options.forEach(option => {
                    const listItem = document.createElement("li");
                    listItem.className = "dropdown-item";

                    const checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.value = option;
                    checkbox.className = "form-check-input option-checkbox me-2";

                    const label = document.createElement("label");
                    label.innerText = option;
                    label.className = "form-check-label";

                    listItem.appendChild(checkbox);
                    listItem.appendChild(label);
                    dropdownMenu.appendChild(listItem);
                });

                // Create container for tags
                const tagContainer = document.createElement("div");
                tagContainer.className = "border rounded p-2 d-flex flex-wrap mt-2";

                // Append elements to the container
                container.appendChild(dropdownButton);
                container.appendChild(dropdownMenu);
                container.appendChild(tagContainer);

                // Function to update the tag display and hidden input value
                const updateTags = () => {
                    tagContainer.innerHTML = "";
                    let selectedValues = [];

                    // Get all checkboxes within this container
                    const checkboxes = container.querySelectorAll(".option-checkbox");
                    checkboxes.forEach(checkbox => {
                        if (checkbox.checked) {
                            selectedValues.push(checkbox.value);
                            // Create a tag element with a remove button
                            const tagElement = document.createElement("span");
                            tagElement.className = "badge bg-light text-dark me-2 p-2 d-flex align-items-center";
                            tagElement.innerHTML = `${checkbox.value} 
          <button type="button" class="btn-close ms-2" aria-label="Remove"></button>`;
                            // Remove tag event handler
                            tagElement.querySelector("button").addEventListener("click", () => {
                                checkbox.checked = false;
                                updateTags();
                            });
                            tagContainer.appendChild(tagElement);
                        }
                    });

                    // Update hidden input as JSON string of selected values
                    hiddenInput.value = JSON.stringify(selectedValues);
                };

                // Listen for changes on checkboxes within the dropdown menu
                dropdownMenu.addEventListener("change", function (event) {
                    if (event.target.matches(".option-checkbox")) {
                        updateTags();
                    }
                });
            }

            // Initialize dropdowns for Features and Games
            createMultiSelectDropdown("featuresDropdown", "featuresInput", ["Indoor Courts",
                "Outdoor Courts",
                "Lockers",
                "Shower Rooms",
                "Equipment Rental",
                "Parking",
                "Snack Bar / Cafe",
                "Seating / Spectator Area",
                "Scoreboards",
                "Online Booking",
                "Wheelchair Accessibility",
                "First Aid Station",
                "Lighting",
                "Changing Rooms",
                "Wi-Fi",
                "Pro Shop",
                "Membership Plans"]);
            createMultiSelectDropdown("gamesDropdown", "gamesInput", ["Padel", "Snooker", "Darts"]);

        </script>
        <!-- END #content -->
        <!-- BEGIN btn-scroll-top -->
        <%- include('../partials/footer') %>